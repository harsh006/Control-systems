\begin{enumerate}[label=\arabic*.,ref=\theenumi]
%\begin{enumerate}[label=\thesection.\arabic*.,ref=\thesection.\theenumi]
\numberwithin{equation}{enumi}
\item Find the frequency of oscillation for given hartley circuit and also find condition on $g_m$.\newline 
Below is the figure, Fig \ref{fig:ee18btech11019_fig1}

\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11019_1.tex}}
	\end{center}
\caption{Hartley oscillator}
\label{fig:ee18btech11019_fig1}
\end{figure}
\solution We will first draw an equivalent circuit for the above circuit.\newline
To draw an equivalent block diagram we will draw small signal model for transistor.\ref{fig:ee18btech11019_fig2}
\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11019_2.tex}}
	\end{center}
\caption{Small signal model}
\label{fig:ee18btech11019_fig2}
\end{figure}
And, its block diagram is as follows: \newline

\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11019_3.tex}}
	\end{center}
\caption{Block diagram}
\label{fig:ee18btech11019_fig3}
\end{figure}

Here G(s) is the amplification gain, and H(s) is the feedback gain.\newline
and G(s) is given by, $\frac{V_o}{V_f}$
\begin{align}
    V_o &= I(sL_1\parallel R)\\
    I &= i_1 + g_mV_f\\
    i_1 &= \frac{V_\pi}{sL_2}\\
\end{align}
Solving these equations we get,\newline
\begin{align}
    \frac{V_o}{V_f} = G(s) = \brak{g_m + \frac{1}{sL_2}}\brak{\frac{RsL_1}{R + sL_1}}
\end{align}
Now, solving for H(s)\newline
From the small signal model feedback, we know that H(s) is output/input, \newline
Where,\newline
Output is $V_f$\newline
Input is $V_o$ \newline
\begin{align}
H(s) &= \frac{V_f}{V_o}\\
V_0 &= V_f + i_1\times \frac{1}{sC}\\
i_1 &= \frac{V_f}{sL_2}\\
\end{align}
Solving,\newline
\begin{align}
    H(s) = \brak{\frac{s^2CL_2}{s^2CL_2 +1}}
\end{align}
Characteristic equation is given by:\newline
\begin{align}
    1+G(s)H(s) = 0
\end{align}
Substituting the values and simplifying, we get\newline
\begin{multline}
    s^3(g_mCL_1L_2 + CL_1L_2) +\\ s^2(RCL_1 + RCL_2) + sL_1 + R =0
\end{multline}
Now, for it to oscillate, roots of the equation should lie on imaginary axis, therefore j$\omega$ should be a solution\newline
Substituting that, we get
\begin{multline}
    (R - \omega^2(RC(L_1 +L_2)) +\\ j(\omega L_1 - \omega^3(g_mR +1)CL_1L_2) = 0
\end{multline}
\textbf{Equating Real part to 0}\newline
\begin{align}
    \omega^2(RC(L_1 +L_2) = R\\
    \omega = \frac{1}{\sqrt{C(L_1 + L_2}}
\end{align}
\textbf{Equating Imaginary part to 0}\newline
\begin{align}
    g_mR + 1 = \frac{C(L_1 +L_2)}{CL_2}\\
    g_mR = \frac{L_1}{L_2}
\end{align}
Therefore to have stable oscillations, we need \newline
$g_mR >= \frac{L_1}{L_2}$\newline\newline
\textbf{Simulation}\newline
For simulation more elaborate circuit of Hartley oscillator was used, i.e. more passive components like capacitors and resistors, so as the the oscillations don't die out quickly, and a voltage source so as the oscillations start.\newline

Below is the circuit which was used \ref{fig:ee18btech11019_fig4}
\begin{figure}[!ht]
	\begin{center}
		\resizebox{\columnwidth}{!}{\input{./figs/ee18btech11019_4.tex}}
	\end{center}
\caption{Simulation circuit}
\label{fig:ee18btech11019_fig4}
\end{figure}


\textbf{Table for parameter values taken}
\begin{table}[!ht]
\centering
\input{./tables/ee18btech11019_1.tex}
\caption{}
\label{table:ee18btech11019_1}
\end{table}
\textbf{Verifying the output}:\newline
Plot generated from transfer function, taking impulse response\newline \ref{fig:ee18btech11019_fig5}
Taking an equivalent R  \newline
$R = L_1$ and $g_mR = \frac{L_1}{L_2}$\newline

\textbf{Code for generating impulse response}
\begin{lstlisting}
codes/ee18btech11019_1.py
\end{lstlisting}
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11019_5.eps}
\caption{Output when taken from transfer function}
\label{fig:ee18btech11019_plot_1}
\end{figure}



\textbf{Actual simulation results}, \newline
Running ngspice netlist file, we produce dat file. From that data we get plot and frequency from  python script found in\newline
\begin{lstlisting}
spice/ee18btech11019_2.py
\end{lstlisting}
Plot:\newline
\begin{figure}[!ht]
\centering
\includegraphics[width=\columnwidth]{./figs/ee18btech11019_6.eps}
\caption{Simulation result}
\label{fig:ee18btech11019_plot_2}
\end{figure}

Frequency obtained is \textbf{3384 Hz}\newline
\textbf{Actual expected frequency is:}
\begin{align}
    = \frac{1}{2\pi \sqrt{C(L_1 +L_2)}}\\
    = 3394 Hz
\end{align}
\end{enumerate}